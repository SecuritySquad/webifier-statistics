---
title: "Webifier Statistics"
output:
  flexdashboard::flex_dashboard:
    orientation: rows
    logo: webifier-small.png
    favicon: webifier-small.png
    theme: lumen
    vertical_layout: fill 
    navbar:
      - { title: "Startseite", href: "https://webifier.de/", align: right }
params:
  dbname: webifier_v0-SNAPSHOT

---

```{r setup, include=FALSE}
usePackage <- function(p)
{
  if (!is.element(p, installed.packages()[,1]))
    install.packages(p, repos='http://cran.r-project.org', dep = TRUE)
}
usePackage('flexdashboard')
usePackage('RMongo')
usePackage('RJSONIO')
library('flexdashboard')
library('RMongo')
library('RJSONIO')
mg1 <- mongoDbConnect(params$dbname)
print(dbShowCollections(mg1))
data <- dbGetQuery(mg1, 'webifierTestResultData', "{}")
```

Row {data-height=100}
-----------------------------------------------------------------------

### analysierte Webseiten

```{r}
valueBox(nrow(data), icon="fa-bar-chart")
```

### saubere Webseiten

```{r}
value <- nrow(data[data$overallResultType=='CLEAN',])
base <- nrow(data)
gauge(value, min = 0, max = base, label = paste(round((value/base)*100),"%",sep=""), gaugeSectors(
  success = c(0, base), warning = c(-10, -5), danger = c(-4, -1)
))
```

### verdächtige Webseiten

```{r}
value <- nrow(data[data$overallResultType=='SUSPICIOUS',])
base <- nrow(data)
gauge(value, min = 0, max = base, label = paste(round((value/base)*100),"%",sep=""), gaugeSectors(
  success = c(-10, -5), warning = c(0, base), danger = c(-4, -1)
))
```

### maliziöse Webseiten

```{r}
value <- nrow(data[data$overallResultType=='MALICIOUS',])
base <- nrow(data)
gauge(value, min = 0, max = base, label = paste(round((value/base)*100),"%",sep=""), gaugeSectors(
  success = c(-4, -1), warning = c(-10, -5), danger = c(0, base)
))
```


Row {.tabset .tabset-fade}
-----------------------------------------------------------------------

### Chart B

```{r}

```

### Chart C

```{r}

```
